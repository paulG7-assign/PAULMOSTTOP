<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Leaderboard â€“ MOST 1</title>
  <style>
    /* same styles as before */
    body {
      background-color: #000;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 50px;
    }
    h1 {
      font-size: 36px;
      margin-bottom: 30px;
    }
    .leaderboard {
      list-style: none;
      padding: 0;
      max-width: 500px;
      margin: 0 auto;
      text-align: left;
    }
    .leaderboard li {
      background: #111;
      margin: 15px 0;
      padding: 20px;
      border-radius: 5px;
      font-size: 18px;
      position: relative;
    }
    .vote-button {
      margin-top: 10px;
      padding: 8px 15px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .vote-button:hover:not(:disabled) {
      background-color: #218838;
    }
    .vote-button:disabled {
      background-color: #555 !important;
      cursor: not-allowed;
    }
    .votes {
      color: #00ff88;
      font-weight: bold;
      margin-top: 8px;
    }
    a.back {
      display: inline-block;
      margin-top: 40px;
      padding: 10px 20px;
      background-color: #007BFF;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }
    a.back:hover {
      background-color: #0056b3;
    }
    .info-msg {
      margin-top: 20px;
      color: #ffcc00;
      font-style: italic;
    }
  </style>
</head>
<body>

  <h1>Leaderboard â€“ MOST HANDSOME</h1>

  <ul class="leaderboard">
    <li>
      ðŸ¥‡ <strong>NAVARRO</strong> â€“ POGI NA MAINGAY<br />
      <button id="vote-btn-0" class="vote-button" onclick="vote(0)">Vote</button>
      <div class="votes" id="votes-0">Votes: 0</div>
    </li>
    <li>
      ðŸ¥ˆ <strong>ABEJUELA</strong> â€“ POGI NA MATALINO<br />
      <button id="vote-btn-1" class="vote-button" onclick="vote(1)">Vote</button>
      <div class="votes" id="votes-1">Votes: 0</div>
    </li>
    <li>
      ðŸ¥‰ <strong>BODUMO</strong> â€“ KUPS NA POGI<br />
      <button id="vote-btn-2" class="vote-button" onclick="vote(2)">Vote</button>
      <div class="votes" id="votes-2">Votes: 0</div>
    </li>
    <li>
      4. <strong>ATIENZA</strong> â€“ POGI NA MASIPAG<br />
      <button id="vote-btn-3" class="vote-button" onclick="vote(3)">Vote</button>
      <div class="votes" id="votes-3">Votes: 0</div>
    </li>
    <li>
      5. <strong>LORENZO</strong> â€“ POGI.<br />
      <button id="vote-btn-4" class="vote-button" onclick="vote(4)">Vote</button>
      <div class="votes" id="votes-4">Votes: 0</div>
    </li>
  </ul>

  <a href="index.html" class="back">â¬… Back to 7-PAUL</a>

  <div class="info-msg" id="info-msg"></div>

  <script>
  const USERS = ["User1", "User2", "User3", "User4", "User5"];
  const STORAGE_KEY = 'mostX_votes'; // replace X per file
  const STORAGE_DATE_KEY = 'mostX_votes_date';
  const STORAGE_VOTED_KEY = 'mostX_voted_flags';
  const HAS_VOTED_ANY_KEY = 'hasVotedAnyMost';
  const RESET_DAYS = 5;

  function loadVotes() {
    const storedDate = localStorage.getItem(STORAGE_DATE_KEY);
    const now = Date.now();

    if (!storedDate || now - storedDate > RESET_DAYS * 86400000) {
      localStorage.setItem(STORAGE_DATE_KEY, now);
      localStorage.setItem(STORAGE_KEY, JSON.stringify([0,0,0,0,0]));
      localStorage.setItem(STORAGE_VOTED_KEY, JSON.stringify([false,false,false,false,false]));
      localStorage.removeItem(HAS_VOTED_ANY_KEY);
      return { votes: [0,0,0,0,0], votedFlags: [false,false,false,false,false] };
    } else {
      const votes = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[0,0,0,0,0]');
      const votedFlags = JSON.parse(localStorage.getItem(STORAGE_VOTED_KEY) || '[false,false,false,false,false]');
      return { votes, votedFlags };
    }
  }

  function saveVotes(votes) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(votes));
  }

  function saveVotedFlags(flags) {
    localStorage.setItem(STORAGE_VOTED_KEY, JSON.stringify(flags));
  }

  function vote(index) {
    if (localStorage.getItem(HAS_VOTED_ANY_KEY)) {
      alert("You already voted.");
      return;
    }

    if (data.votedFlags[index]) return;

    data.votes[index]++;
    data.votedFlags[index] = true;
    localStorage.setItem(HAS_VOTED_ANY_KEY, 'true');

    saveVotes(data.votes);
    saveVotedFlags(data.votedFlags);
    renderLeaderboard();
  }

  function disableAllVotes() {
    const buttons = document.querySelectorAll(".vote-button");
    buttons.forEach(btn => {
      btn.disabled = true;
      btn.textContent = "Vote Disabled";
    });
  }

  function renderLeaderboard() {
    const leaderboard = document.getElementById("leaderboard");
    leaderboard.innerHTML = "";

    // Combine votes + names
    const combined = USERS.map((name, i) => ({
      name,
      votes: data.votes[i],
      index: i
    }));

    // Sort by most votes
    combined.sort((a, b) => b.votes - a.votes);

    // Render sorted list
    combined.forEach((user, rank) => {
      const li = document.createElement("div");
      li.innerHTML = `
        <div style="margin-bottom: 20px;">
          <strong>${rank + 1 === 1 ? "ðŸ¥‡" : rank + 1 === 2 ? "ðŸ¥ˆ" : rank + 1 === 3 ? "ðŸ¥‰" : `${rank + 1}.`}</strong>
          <strong>${user.name}</strong><br>
          <button class="vote-button" id="vote-btn-${user.index}" onclick="vote(${user.index})">Vote</button>
          <div class="votes">Votes: ${user.votes}</div>
        </div>
      `;
      leaderboard.appendChild(li);

      // Disable buttons if voted
      const btn = document.getElementById(`vote-btn-${user.index}`);
      if (localStorage.getItem(HAS_VOTED_ANY_KEY)) {
        btn.disabled = true;
        btn.textContent = "Voted";
      }
    });

    // Message
    if (localStorage.getItem(HAS_VOTED_ANY_KEY)) {
      const msg = document.createElement("div");
      msg.style.color = "#ffcc00";
      msg.style.marginTop = "20px";
      msg.textContent = "You have already voted.";
      leaderboard.appendChild(msg);
    }
  }

  const data = loadVotes();
  renderLeaderboard();
</script>

</body>
</html>
